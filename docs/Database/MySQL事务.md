# MySQL事务

## 定义
MYSQL事务是指对数据库的一组操作要么全部成功，要么全部失败。

## 特性

1. 原子性(Atomicity)：一组操作作为整体进行执行，不会出现部分操作完成，而另外的操作没有完成，强调的是不可分割。
2. 一致性(Consistency)：指的是数据前后的一致性，相比于特性而言，更多强调的是对数据的一种要求。如：数据库本身的约束，一致性读，一致性写，事务中途异常奔溃后数据的一致性，日志与数据的一致性，应用层面保证数据的一致性。
3. 隔离性(Isolation)：指的是读未提交、读已提交、可重复读、串行化。
4. 持久性(Durability)：事务一旦成功提交，即使遇到异常故障也不会丢数据。

#### 隔离级别：

1. 读未提交(READ UNCOMMITTED)：指的是一个事务所做的改动还未提交，其他事务就能看见了。
2. 读已提交(READ COMMITTED)：指的是一个事务所做的改动，必须等该事务提交了，其他事务才能看见。
3. 可重复读(REPEATABLE READ)：指的是在事务启动之后看到的数据自始至终都是一致的（事务启动不是指begin，而是开始执行第一条SQL语句）。
4. 串行化(SERIALIZABLE)：指的是一个事务执行时，对某一行记录针对写操作会加写锁，读操作会加读锁，当出现锁冲突的时候，一个事务必须等另一个事务执行结束后，才可以执行。

[事务隔离性](drawio/事务隔离性.drawio ':include :type=code')

如上图，假设test表中x=0
读未提交：T3时刻，事务A能读到事务B修改的x=1。
读已提交：T3时刻，事务A读到x=0，T5时刻，事务A才能读到事务B修改的值。
可重复读：T3和T5时刻，由于拿到的一致性视图是一样的，所以事务A都读到x=0。
